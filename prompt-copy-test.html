<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡¬í”„íŠ¸ ë³µì‚¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .blog-post {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background: #fafafa;
        }
        .blog-title {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        .blog-content {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        .copy-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        .copy-button:hover {
            background: #0056b3;
        }
        .copy-button:active {
            background: #004085;
        }
        .copy-button.copied {
            background: #28a745;
        }
        .prompt-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
            white-space: pre-wrap;
            display: none;
        }
        .success-message {
            color: #28a745;
            font-weight: bold;
            margin-top: 10px;
            display: none;
        }
        .error-message {
            color: #dc3545;
            font-weight: bold;
            margin-top: 10px;
            display: none;
        }
        .api-test {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .api-test input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .api-test button {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h1>
        <p>ì´ í˜ì´ì§€ëŠ” í”„ë¡¬í”„íŠ¸ ë³µì‚¬ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        
        <!-- ìƒ˜í”Œ ë¸”ë¡œê·¸ ê¸€ë“¤ -->
        <div class="blog-post">
            <div class="blog-title">ğŸœ ë§›ìˆëŠ” ë¼ë©˜ ë§›ì§‘ ì¶”ì²œ</div>
            <div class="blog-content">
                ì˜¤ëŠ˜ì€ ì •ë§ ë§›ìˆëŠ” ë¼ë©˜ ë§›ì§‘ì„ ì†Œê°œí•´ë“œë¦´ê²Œìš”! 
                ì´ê³³ì€ ì •í†µ ì¼ë³¸ ë¼ë©˜ì˜ ë§›ì„ ê·¸ëŒ€ë¡œ ì¬í˜„í•œ ê³³ìœ¼ë¡œ, 
                íŠ¹íˆ ëˆì½”ì¸  ë¼ë©˜ì´ ì •ë§ ì¼í’ˆì…ë‹ˆë‹¤...
            </div>
            <button class="copy-button" onclick="copyPrompt(1)">
                ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°
            </button>
            <div class="prompt-info" id="prompt-1"></div>
            <div class="success-message" id="success-1">âœ… í”„ë¡¬í”„íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
            <div class="error-message" id="error-1">âŒ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>
        </div>
        
        <div class="blog-post">
            <div class="blog-title">â˜• íë§ë˜ëŠ” ì¹´í˜ ê³µê°„</div>
            <div class="blog-content">
                ë°”ìœ ì¼ìƒ ì†ì—ì„œ ì ì‹œ ì‰¬ì–´ê°ˆ ìˆ˜ ìˆëŠ” ì•„ëŠ‘í•œ ì¹´í˜ë¥¼ ë°œê²¬í–ˆì–´ìš”. 
                ì´ê³³ì€ ì°½ê°€ì— ì•‰ìœ¼ë©´ ë„ì‹œì˜ ì•„ë¦„ë‹¤ìš´ í’ê²½ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆê³ , 
                ì»¤í”¼ í–¥ê³¼ í•¨ê»˜ í¸ì•ˆí•œ ì‹œê°„ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤...
            </div>
            <button class="copy-button" onclick="copyPrompt(2)">
                ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°
            </button>
            <div class="prompt-info" id="prompt-2"></div>
            <div class="success-message" id="success-2">âœ… í”„ë¡¬í”„íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
            <div class="error-message" id="error-2">âŒ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>
        </div>
        
        <div class="blog-post">
            <div class="blog-title">ğŸª í¸ì˜ì  ê¿€íŒ ëª¨ìŒ</div>
            <div class="blog-content">
                í¸ì˜ì ì—ì„œ ì•Œë©´ ì¢‹ì€ ê¿€íŒë“¤ì„ ì •ë¦¬í•´ë´¤ì–´ìš”! 
                í• ì¸ ì‹œê°„ëŒ€ë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ë¶€í„°, 
                ë§›ìˆëŠ” í¸ì˜ì  ìŒì‹ ì¡°í•©ê¹Œì§€...
            </div>
            <button class="copy-button" onclick="copyPrompt(3)">
                ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°
            </button>
            <div class="prompt-info" id="prompt-3"></div>
            <div class="success-message" id="success-3">âœ… í”„ë¡¬í”„íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
            <div class="error-message" id="error-3">âŒ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>
        </div>
        
        <!-- API í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
        <div class="api-test">
            <h3>ğŸ”§ API ì§ì ‘ í…ŒìŠ¤íŠ¸</h3>
            <p>Made IDë¥¼ ì…ë ¥í•˜ì—¬ ì‹¤ì œ APIë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”:</p>
            <input type="number" id="madeIdInput" placeholder="Made ID ì…ë ¥ (ì˜ˆ: 1)" value="1">
            <button onclick="testPromptCopyAPI()">í”„ë¡¬í”„íŠ¸ ë³µì‚¬ API í…ŒìŠ¤íŠ¸</button>
            <button onclick="testPromptStatsAPI()">í”„ë¡¬í”„íŠ¸ í†µê³„ API í…ŒìŠ¤íŠ¸</button>
            <div id="apiResult" style="margin-top: 15px; padding: 10px; background: white; border-radius: 4px; display: none;"></div>
        </div>
    </div>

    <script>
        // í”„ë¡¬í”„íŠ¸ ë³µì‚¬ í•¨ìˆ˜
        async function copyPrompt(blogId) {
            const button = event.target;
            const promptInfo = document.getElementById(`prompt-${blogId}`);
            const successMsg = document.getElementById(`success-${blogId}`);
            const errorMsg = document.getElementById(`error-${blogId}`);
            
            try {
                // 1. ë°±ì—”ë“œ APIì—ì„œ í”„ë¡¬í”„íŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const response = await fetch(`http://localhost:8081/api/made/${blogId}/prompt-copy`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const promptData = await response.json();
                
                // 2. í”„ë¡¬í”„íŠ¸ ì •ë³´ í‘œì‹œ
                promptInfo.style.display = 'block';
                promptInfo.textContent = `í”„ë¡¬í”„íŠ¸: ${promptData.prompt}\n\nì‚¬ìš©ì ì…ë ¥: ${promptData.userInput}\n\në§¤ì¥: ${promptData.storeName}`;
                
                // 3. í´ë¦½ë³´ë“œì— í”„ë¡¬í”„íŠ¸ ë³µì‚¬
                await navigator.clipboard.writeText(promptData.prompt);
                
                // 4. ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                successMsg.style.display = 'block';
                errorMsg.style.display = 'none';
                button.textContent = 'âœ… ë³µì‚¬ ì™„ë£Œ!';
                button.classList.add('copied');
                
                // 5. ë³µì‚¬ ì™„ë£Œ ë¡œê¹… (ë°±ì—”ë“œì— ì•Œë¦¼)
                await fetch(`http://localhost:8081/api/prompts/${blogId}/copy-complete`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `copiedBy=test-user-${blogId}`
                });
                
                // 3ì´ˆ í›„ ë²„íŠ¼ ì›ë˜ëŒ€ë¡œ ë³µì›
                setTimeout(() => {
                    button.textContent = 'ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°';
                    button.classList.remove('copied');
                    successMsg.style.display = 'none';
                }, 3000);
                
            } catch (error) {
                console.error('í”„ë¡¬í”„íŠ¸ ë³µì‚¬ ì‹¤íŒ¨:', error);
                errorMsg.style.display = 'block';
                successMsg.style.display = 'none';
                promptInfo.style.display = 'none';
                
                // ì—ëŸ¬ ë©”ì‹œì§€ë„ 3ì´ˆ í›„ ìˆ¨ê¹€
                setTimeout(() => {
                    errorMsg.style.display = 'none';
                }, 3000);
            }
        }
        
        // í”„ë¡¬í”„íŠ¸ ë³µì‚¬ API í…ŒìŠ¤íŠ¸
        async function testPromptCopyAPI() {
            const madeId = document.getElementById('madeIdInput').value;
            const resultDiv = document.getElementById('apiResult');
            
            try {
                const response = await fetch(`http://localhost:8081/api/made/${madeId}/prompt-copy`);
                const data = await response.json();
                
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h4>âœ… í”„ë¡¬í”„íŠ¸ ë³µì‚¬ API í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h4>âŒ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</h4>
                    <p>ì—ëŸ¬: ${error.message}</p>
                `;
            }
        }
        
        // í”„ë¡¬í”„íŠ¸ í†µê³„ API í…ŒìŠ¤íŠ¸
        async function testPromptStatsAPI() {
            const madeId = document.getElementById('madeIdInput').value;
            const resultDiv = document.getElementById('apiResult');
            
            try {
                // ë¨¼ì € í”„ë¡¬í”„íŠ¸ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ í”„ë¡¬í”„íŠ¸ ë‚´ìš©ì„ ì¶”ì¶œ
                const promptResponse = await fetch(`http://localhost:8081/api/made/${madeId}/prompt-copy`);
                const promptData = await promptResponse.json();
                
                // í”„ë¡¬í”„íŠ¸ í†µê³„ API í˜¸ì¶œ
                const statsResponse = await fetch(`http://localhost:8081/api/prompts/stats?prompt=${encodeURIComponent(promptData.prompt)}`);
                const statsData = await statsResponse.json();
                
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h4>âœ… í”„ë¡¬í”„íŠ¸ í†µê³„ API í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                    <pre>${JSON.stringify(statsData, null, 2)}</pre>
                `;
            } catch (error) {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h4>âŒ í”„ë¡¬í”„íŠ¸ í†µê³„ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</h4>
                    <p>ì—ëŸ¬: ${error.message}</p>
                `;
            }
        }
    </script>
</body>
</html>
